var ajaxurl=meta_image.ajaxurl,user={onReady:function(){user.imageUploader(),user.removeUserImage(),user.removeVideo()},imageUploader:function(){var e;jQuery(".upload-image").click(function(t){t.preventDefault();var a=jQuery(this),r=jQuery(this).parent(),u=r.attr("data-img"),o=r.attr("data-input"),i=r.attr("data-user"),n=jQuery("#"+o),m=jQuery("."+u);e=wp.media.frames.meta_image_frame=wp.media({title:meta_image.title,button:{text:meta_image.button},library:{type:"image, video"},multiple:!0}),e.on("select",function(){var t=e.state().get("selection").first().toJSON();m.find("img").remove(),"bg_video"===u?(m.append('<video muted autoplay id="bgvid" loop><source src="'+t.url+'" type="video/webm"><source src="'+t.url+'" type="video/ogv"><source src="'+t.url+'" type="video/mp4"></video>'),n.val(t.url),r.append('<button class="remove-video button button-large">Remove</button>'),a.remove()):(m.append('<img src="'+t.url+'" alt="" />'),n.val(t.url),r.append('<button class="remove-image button button-large">Remove</button>'),a.remove(),user.saveUserImage(o,i,t.url))}),e.open()})},removeVideo:function(){jQuery(".remove-video").click(function(e){e.preventDefault();var t=jQuery(this).parent().attr("data-img");jQuery("."+t).html(""),jQuery("#custom_"+t).val(""),jQuery(this).parent().append('<button class="add button button-large upload-image" style="text-align:center;">Upload/Set Video</button>'),jQuery(this).remove(),user.imageUploader()})},removeUserImage:function(){jQuery(".remove-image").click(function(e){e.preventDefault();var t=jQuery(this).parent().attr("data-input"),a=jQuery(this).parent().attr("data-user");jQuery(this).parent().find("input").val(""),jQuery(this).parent().find("img").remove(),user.saveUserImage(t,a,""),jQuery(this).parent().append('<button class="add button button-large upload-image" id="upload-logo" style="text-align:center;" data-input="agent_image" data-img="profile" data-user="<?php echo $user_id; ?>">Upload/Set Profile Image</button>'),jQuery(this).remove(),user.imageUploader()})},saveUserImage:function(e,t,a){jQuery.ajax({url:ajaxurl,type:"GET",data:{imageField:e,fieldVal:a,userID:t,action:"setImage"},dataType:"html",success:function(){user.removeImage()},error:function(e,t,a){window.alert(e+" :: "+t+" :: "+a)}})}};jQuery(document).ready(function(){user.onReady()});